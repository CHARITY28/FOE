library(vcd)
data("Arthritis")

table(Arthritis$Treatment)
prop.table(table(Arthritis$Treatment))

table(Arthritis$Treatment, Arthritis$Improved)
addmargins(table(Arthritis$Treatment, Arthritis$Improved))

### What is the probability of mrked improvement when treated
treat_improve_prob_table<-prop.table(table(Arthritis$Treatment, Arthritis$Improved))
treat_improve_prob_table["Treated","Marked"]

### what is the probability that a person sees marked improvement if they were administered a placebo 
treat_improve_mar_table<-addmargins(table(Arthritis$Treatment, Arthritis$Improved))
treat_improve_mar_table
treat_improve_mar_table[1,3]/treat_improve_mar_table[1,4]
treat_improve_mar_table["Placebo","Marked"]/treat_improve_mar_table["Placebo","Sum"]

prop.table(table(Arthritis$Treatment, Arthritis$Improved), margin = 1)
prop.table(table(Arthritis$Treatment, Arthritis$Improved), margin = 1)["Placebo","Marked"]

prop.table(table(Arthritis$Treatment, Arthritis$Improved), margin = 2)

########## Mosaic Plot in R ##########################################
library(vcd)
data("Arthritis")
library(tidyverse)
#install.packages("ggmosaic")
library(ggmosaic)
# Using R-base
plot(table(Arthritis$Treatment, Arthritis$Improved))

plot(table(Arthritis$Treatment, Arthritis$Improved), main ="Mosaic table for Arthritis Treatment", 
     color = c(2,3,4))

plot(table(Arthritis$Treatment, Arthritis$Improved), main ="Mosaic table for Arthritis Treatment", 
     xlab="treatment", ylab="improved", color = c("light blue","White","light green") )

plot(table(Arthritis$Treatment, Arthritis$Improved), main ="Mosaic table for Arthritis Treatment", 
     xlab="treatment", ylab="improved", color = c(2,3, 4) )

# Using 
ggplot(data = Arthritis) +
  geom_mosaic(aes(x = product(Treatment), fill = Improved))

mosaicplot(table(Arthritis$Treatment, Arthritis$Improved))

#### Joint probability
# The area of any cell in the mosaic plot

### Marginal probability
# The area of any column or row (same colour)

### Conditional probability - Bayes probability
# the area of one cell over the total area of the cells of same colour
